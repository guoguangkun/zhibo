## 5.3 IJKplayer框架介绍

IJKplayer是Bilibili网站工程师基于FFmpeg及MediaCodec开发的开源播放器框架，内部实现了软解及硬解的功能，其基本框架如下图所示：
![](/assets/图5.3-1.png)
针对各种铺天盖地的播放器项目，我们选取了比较出众的IJKplayer进行源码剖析。它是一个基于FFPlay的轻量级Android/iOS视频播放器，实现了跨平台的功能，API易于集成；编译配置可裁剪，方便控制安装包大小。

### 一、总体说明

打开ijkplayer，可看到其主要目录结构如下:

| 目录名称| 说明 |
| :--- | :--- | 
| tool| 初始化项目工程脚本|
| config| 编译ffmpeg使用的配置文件|
| extra| 存放编译ijkplayer所需的依赖源文件, 如ffmpeg、openssl等|
| ijkmedia| 核心代码|
| ijkplayer| 播放器数据下载及解码相关|
| ijksdl| 音视频数据渲染相关|
| ios| iOS平台上的上层接口封装以及平台相关方法|
| android| Android平台上的上层接口封装以及平台相关方法|

在功能的具体实现上，iOS和Android平台的差异主要表现在视频硬件解码以及音视频渲染方面，两者实现的载体区别如下表所示：

| Platform | Hardware Codec | Video Render | Audio Output |
| :--- | :--- | :--- | :--- |
| iOS | VideoToolBox | OpenGL ES | AudioQueue |
| Android | MediaCodec | OpenGL ES、MediaCodec | OpenSL ES、AudioTrack |

特性列表

| 特性名称| 说明 |
| :--- | :--- |
| Android平台| 支持API 9〜23|
| CPU | ARMv7a，ARM64v8a，x86（ARMv5未在真实设备上测试）|
| API | API提供丰富的方法，易于集成|
| 视频输出 | NativeWindow，OpenGL ES 2.0|
| 音频输出| AudioTrack，OpenSL ES|
| 编解码器| MediaCodec（API 16+，Android 4.1+）|
| 其他| 可替代android.media.MediaPlayer，ExoPlayer|





